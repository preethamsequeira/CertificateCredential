<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Certificate Verifier</title>
    <style>
        body { font-family: sans-serif; background: #f4f7f9; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); width: 90%; max-width: 450px; text-align: center; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #a435f0; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #a435f0; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hidden { display: none; }
        .result { text-align: left; background: #e8f5e9; border: 1px solid #2e7d32; padding: 15px; border-radius: 8px; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div id="input-view">
        <h2>Live Verification</h2>
        <p>Paste a public Udemy Certificate URL:</p>
        <input type="text" id="urlInput" placeholder="https://www.udemy.com/certificate/...">
        <button onclick="fetchCertificate()">Verify from Web</button>
        <div id="loading" class="loader"></div>
    </div>

    <div id="result-view" class="hidden">
        <h2 style="color: #2e7d32;">âœ” Verified Successfully</h2>
        <div class="result">
            <p><strong>Recipient:</strong> <span id="studentName"></span></p>
            <p><strong>Course:</strong> <span id="courseName"></span></p>
        </div>
        <button onclick="location.reload()" style="background:#333; margin-top:10px;">New Search</button>
    </div>
</div>

<script>
    async function fetchCertificate() {
        const url = document.getElementById('urlInput').value;
        const loader = document.getElementById('loading');
        
        if (!url.includes('udemy.com/certificate/')) {
            alert("Please enter a valid Udemy Certificate URL");
            return;
        }

        loader.style.display = "block";

        try {
            // We use 'allorigins' as a free proxy to bypass CORS
            const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;
            const response = await fetch(proxyUrl);
            const data = await response.json();
            
            // This is the "Scraping" part. We turn the text into a temporary document.
            const parser = new DOMParser();
            const doc = parser.parseFromString(data.contents, 'text/html');

            // Udemy stores the student name in the <title> or specific <h1> tags
            // We search for common patterns in their HTML structure
            const pageTitle = doc.title; // e.g., "Certificate | Udemy"
            const mainHeading = doc.querySelector('h1')?.innerText || "Not Found";
            
            // Note: Scrapers depend on the website's HTML structure. 
            // This is a simplified example of extracting data.
            if (data.contents.includes("invalid") || !data.contents) {
                throw new Error("Invalid");
            }

            // Logic to display results
            document.getElementById('input-view').classList.add('hidden');
            document.getElementById('result-view').classList.remove('hidden');
            
            // Simplified "Guessing" of the name from the title
            document.getElementById('studentName').innerText = "Verified User"; 
            document.getElementById('courseName').innerText = pageTitle.replace(" | Udemy", "");

        } catch (error) {
            alert("Error: Could not fetch data. The certificate might be private or the link is broken.");
            loader.style.display = "none";
        }
    }
</script>
</body>
</html>
